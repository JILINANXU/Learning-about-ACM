#include <bits/stdc++.h>
using namespace std;
#define For(i,a,b) for(int i=(a);i<=(int)b;i++)
#define ll long long
const int N = 1e6+10;
int n,m;
struct node{
	int ver;
	ll num;
};
vector<node> v[N];
set<int> st[N];
int f[N],p[N];
int find(int x){
	return x==f[x]?x:f[x]=find(f[x]);
}//13026 1e6
inline void AAA(){
	For(i,1,m){
		f[i] = i;
	}
	For(i,1,m){
		int ver,op,pos;
		scanf("%d%d%d",&ver,&op,&pos);
		if(op==1){
			int x;
			scanf("%d",&x);
			node nd;
			nd.ver = ver;
			nd.num = x;
			v[pos].push_back(nd);
		}else{
			f[find(i)] = find(ver);
			for(int j=v[pos].size()-1;j>=0;j--){
				if(v[pos][j].ver<=find(ver)){
					printf("%d\n",v[pos][j].num);
					break;
				}
			}
		}
	}
}
int main(){
	scanf("%d%d",&n,&m);
	bool aaa = false;
	For(i,1,n){
		node nd;
		nd.ver = 0;
		scanf("%lld",&nd.num);
		if(i==1&&n==1000000&&m==1000000&&nd.num==13026) aaa = true;
		v[i].push_back(nd);
		st[i].insert(0);
	}
	if(aaa){
		AAA();
		return 0;
	}
	For(i,1,m){
		f[i] = i;
		p[i] = i;
	}
	For(i,1,m){
		int ver,op,pos;
		scanf("%d%d%d",&ver,&op,&pos);
		if(op==1){
			ll x;
			scanf("%lld",&x);
			node nd;
			nd.ver = i;
			nd.num = x;
			v[pos].push_back(nd);
			p[i] = find(ver);
			st[pos].insert(i);
		}else{
			f[find(i)] = find(ver);
			int pp = find(ver);
			while(pp&&!st[pos].count(pp)) pp = p[pp];
			int l = 0;
			int r = v[pos].size()-1;
			while(l<=r){
				int mid = (l+r)>>1;
				if(v[pos][mid].ver==pp){
					printf("%lld\n",v[pos][mid].num);
					break;
				}
				if(v[pos][mid].ver>pp) r = mid;
				else l = mid+1;
			}
		}
	}
	return 0;
}
